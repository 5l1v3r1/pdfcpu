/*
Copyright 2020 The pdfcpu Authors.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

	http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

package pdfcpu

import (
	"fmt"
	"testing"
)

func TestParseContentStream(t *testing.T) {

	// 	s := `0.50 0.75 1.00 [(Applig)-15(ent)]TJ a b
	// (P: 610 \200 F: 610.284 \200 email: sales)Tj 0.00 600.00 600.00 re
	// B BT /F0 24.00 Tf ET q 1.00 0.00 0.00 1.00 0.00 0.26
	// Td 0 Tr [ (0,0) 0 ( ) (\(botleft\)) ] TJ ET BT 0 Tw 0.00 0.00
	// 0.00 RG 0.00 0.00 0.00 rg 0.00 6.00 Td 0 Tr (and line2) Tj ET
	// Q 0.00 300.00 m 600.00 300.00 l s 300.00 0.00 m 300.00 600.00
	// l s 0.00 300.00 m 600.00 300.00 l s 300.00 0.00 m 300.00 600.00
	// l s 0.75 0.75 1.00 rg 0.00 w 50.00 70.00 200.00 200.00 re B
	// BT /F0 8.00 Tf ET q 1.00 0.00 0.00 1.00 50.00 70.75 cm 1.00
	// 0.98 0.77 rg 0.00 w 0.00 0.00 40.46 18.50 re B 0.90 0.90 0.90
	// rg 0.00 w 0.00 0.00 40.46 18.50 re B BT 0 Tw 0.00 0.00 0.00 RG
	// 0.00 0.00 0.00 rg 0.00 11.25 Td 0 Tr [ (0,0) 0 ( ) (\(botleft\)) ] TJ
	// ET BT 0 Tw 0.00 0.00 0.00 RG 0.00 0.00 0.00 rg 0.00 2.00 Td 0
	// Tr (and\) line2) Tj ET Q 50.00 70.00 m 250.00 70.00 l s 50.00 70.00
	// m 50.00 270.00 l s 50.00 170.00 m 250.00 170.00 l s 150.00 70.00 m 150.00 270.00 l s`

	s := `/CS0 cs 0.26669 0.349 0.149  scn
/RelativeColorimetric ri
/GS0 gs
BT
/T1_0 1 Tf
0 Tc 0 Tw 0  Ts 100  Tz 0 Tr 10 0 0 10 136.541 56.5 Tm
[(22 East Baltimore A)25(venue \200 Lansdowne, P)38(A  19050 \200 www)55(.appligent.com)]TJ
ET
/CS0 CS 0.1373 0.1216 0.1255  SCN
1 w 4 M 0 j 0 J []0 d 
/GS1 gs
36 50 m
576 50 l
S
/GS2 gs
BT
/T1_0 1 Tf
10 0 0 10 158.563 40.5 Tm
(P: 610.284.4006 \200 F: 610.284.4233 \200 email: sales@appligent.com)Tj
0 0.4314 0.3569  scn
/T1_1 1 Tf
48 0 0 48 36 724.61719 Tm
[(Applig)-15(ent)]TJ
ET
/Document /MC0 BDC 
0 0.5098 0.4431  scn
/GS0 gs
49.757 75.75 m
43.476 75.75 38.38301 81.36101 38.38301 88.27901 c
38.38301 153.97101 l
38.38301 160.88901 43.476 166.5 49.757 166.5 c
106.33701 166.5 l
112.61801 166.5 117.71901 160.88901 117.71901 153.97101 c
117.71901 88.27901 l
117.71901 81.36101 112.61801 75.75 106.33701 75.75 c
49.757 75.75 l
f
q
107.75 102.78801 m
88.623 102.78801 l
88.623 105.218 l
68.38101 105.218 l
68.38101 102.78801 l
60.28601 102.78801 l
60.28601 105.218 l
47.382 105.218 l
47.382 160.966 l
107.75 160.966 l
107.75 102.78801 l
W n
q
60.46581 0 0 58.272 47.334 102.744 cm
/Im0 Do
Q
Q
q
39.62401 82.58301 m
36 82.58301 l
36 105.218 l
38.38301 105.218 l
38.38301 88.27901 l
38.38301 86.22801 38.83 84.29201 39.62401 82.58301 c
W n
q
4.392 0 0 23.472 35.57401 82.164 cm
/Im1 Do
Q
Q
q
49.76401 82.58301 m
39.62401 82.58301 l
38.83 84.29201 38.38301 86.22801 38.38301 88.27901 c
38.38301 105.218 l
47.382 105.218 l
47.382 102.78801 l
60.28601 102.78801 l
60.28601 101.313 l
49.76401 101.313 l
49.76401 96.65302 l
49.46501 97.43001 l
49.21001 98.04102 49.028 98.49701 48.91901 98.80602 c
48.71501 99.38901 48.48201 99.93001 48.21901 100.436 c
47.899 100.436 l
47.61501 100.42201 l
47.433 99.867 47.28 99.42401 47.15601 99.09401 c
46.64601 97.78801 46.31801 96.95201 46.18701 96.58701 c
45.32701 94.26201 l
45.188 93.87601 45.043 93.50401 44.89 93.14601 c
44.839 93.033 44.722 92.71701 44.533 92.19101 c
44.13901 91.08801 43.782 90.23801 43.461 89.634 c
43.308 89.36 43.12601 89.164 42.908 89.05101 c
42.82701 89.009 42.543 88.96701 42.07701 88.93201 c
41.968 88.925 41.895 88.91801 41.851 88.91801 c
41.64 88.91801 l
41.57401 88.91801 41.494 88.897 41.407 88.841 c
41.38501 88.763 41.37 88.707 41.37 88.658 c
41.37 88.60201 l
41.61101 88.58101 41.8 88.57401 41.946 88.57401 c
42.033 88.57401 42.186 88.58101 42.39801 88.60201 c
42.711 88.61601 42.937 88.623 43.06801 88.623 c
43.192 88.623 43.41 88.61601 43.709 88.60201 c
44.358 88.56 44.92601 88.539 45.42101 88.539 c
45.567 88.539 45.77901 88.54601 46.05501 88.54601 c
46.08501 88.679 l
45.983 88.82701 l
44.729 88.93201 l
44.51801 88.96001 44.343 88.99501 44.21901 89.03 c
44.16101 89.15001 44.132 89.24101 44.132 89.29701 c
44.132 89.38901 44.30701 89.901 44.649 90.828 c
45.44301 93.26501 l
45.472 93.34201 45.52301 93.46901 45.59601 93.64401 c
45.851 93.68001 46.07701 93.68701 46.289 93.68701 c
46.864 93.68001 l
48.817 93.701 l
49.006 93.701 49.23201 93.68001 49.48 93.63701 c
49.58301 93.367 49.677 93.11801 49.76401 92.88802 c
49.76401 88.94101 l
49.422 88.91801 l
49.22501 88.86201 l
49.196 88.785 49.17401 88.707 49.17401 88.623 c
49.36301 88.57401 l
49.56801 88.57401 l
49.61801 88.57401 49.68401 88.567 49.76401 88.56 c
49.76401 82.58301 l
W n
q
22.812 0 0 23.472 37.914 82.164 cm
/Im2 Do
Q
Q
q
60.28601 102.78801 m
47.382 102.78801 l
47.382 105.218 l
60.28601 105.218 l
60.28601 102.78801 l
W n
q
13.43449 0 0 2.65199 47.274 102.68401 cm
/Im3 Do
Q
Q
q
48.015 94.03101 m
47.17801 94.03101 46.43401 94.052 45.77901 94.08 c
45.72701 94.12201 l
45.77101 94.21301 45.8 94.30501 45.82201 94.39601 c
45.84401 94.48701 45.895 94.649 45.983 94.873 c
46.07001 95.09801 46.14999 95.33 46.23 95.55501 c
46.39801 96.067 46.675 96.78401 47.061 97.70401 c
47.287 98.23701 47.425 98.539 47.46201 98.61 c
47.54901 98.455 l
48.394 96.41801 l
48.431 96.30602 48.657 95.744 49.05 94.71901 c
49.138 94.522 49.203 94.30501 49.269 94.07301 c
48.90401 94.04501 48.489 94.03101 48.015 94.03101 c
W n
q
4.392 0 0 5.35201 45.354 93.50401 cm
/Im4 Do
Q
Q
1 1 1  scn
45.77901 94.08 m
46.43401 94.052 47.17801 94.03101 48.015 94.03101 c
48.489 94.03101 48.90401 94.04501 49.269 94.07301 c
49.203 94.30501 49.138 94.522 49.05 94.71901 c
48.657 95.744 48.431 96.30602 48.394 96.41801 c
47.54901 98.455 l
47.46201 98.61 l
47.425 98.539 47.287 98.23701 47.061 97.70401 c
46.675 96.78401 46.39801 96.067 46.23 95.55501 c
46.14999 95.33 46.07001 95.09801 45.983 94.873 c
45.895 94.649 45.84401 94.48701 45.82201 94.39601 c
45.8 94.30501 45.77101 94.21301 45.72701 94.12201 c
45.77901 94.08 l
41.407 88.841 m
41.494 88.897 41.57401 88.91801 41.64 88.91801 c
41.851 88.91801 l
41.895 88.91801 41.968 88.925 42.07701 88.93201 c
42.543 88.96701 42.82701 89.009 42.908 89.05101 c
43.12601 89.164 43.308 89.36 43.461 89.634 c
43.782 90.23801 44.13901 91.08801 44.533 92.19101 c
44.722 92.71701 44.839 93.033 44.89 93.14601 c
45.043 93.50401 45.188 93.87601 45.32701 94.26201 c
46.18701 96.58701 l
46.31801 96.95201 46.64601 97.78801 47.15601 99.09401 c
47.28 99.42401 47.433 99.867 47.61501 100.42201 c
47.899 100.436 l
48.21901 100.436 l
48.48201 99.93001 48.71501 99.38901 48.91901 98.80602 c
49.028 98.49701 49.21001 98.04102 49.46501 97.43001 c
50.864 93.79201 l
51.61501 91.811 l
52.00801 90.688 52.26401 89.992 52.38701 89.74001 c
52.511 89.48 52.621 89.311 52.73 89.22701 c
52.759 89.20601 52.87601 89.17101 53.07201 89.12201 c
53.269 89.07201 53.41501 89.037 53.48801 89.01601 c
53.772 88.93201 53.96901 88.86201 54.078 88.79901 c
54.114 88.63 l
54.08501 88.483 l
53.89601 88.483 53.757 88.47601 53.677 88.47601 c
53.364 88.47601 52.81 88.49701 52.02301 88.539 c
51.09801 88.56 l
49.983 88.54601 l
49.91701 88.54601 49.83701 88.55301 49.76401 88.56 c
49.68401 88.567 49.61801 88.57401 49.56801 88.57401 c
49.36301 88.57401 l
49.17401 88.623 l
49.17401 88.707 49.196 88.785 49.22501 88.86201 c
49.422 88.91801 l
50.369 88.981 l
50.617 88.99501 50.806 89.03 50.93001 89.07901 c
50.96701 89.18501 50.98801 89.26901 50.98801 89.32501 c
50.98801 89.43102 50.908 89.705 50.748 90.147 c
50.63901 90.44901 50.54401 90.73 50.45601 90.99701 c
50.37601 91.26401 50.048 92.14201 49.48 93.63701 c
49.23201 93.68001 49.006 93.701 48.817 93.701 c
46.864 93.68001 l
46.289 93.68701 l
46.07701 93.68701 45.851 93.68001 45.59601 93.64401 c
45.52301 93.46901 45.472 93.34201 45.44301 93.26501 c
44.649 90.828 l
44.30701 89.901 44.132 89.38901 44.132 89.29701 c
44.132 89.24101 44.16101 89.15001 44.21901 89.03 c
44.343 88.99501 44.51801 88.96001 44.729 88.93201 c
45.983 88.82701 l
46.08501 88.679 l
46.05501 88.54601 l
45.77901 88.54601 45.567 88.539 45.42101 88.539 c
44.92601 88.539 44.358 88.56 43.709 88.60201 c
43.41 88.61601 43.192 88.623 43.06801 88.623 c
42.937 88.623 42.711 88.61601 42.39801 88.60201 c
42.186 88.58101 42.033 88.57401 41.946 88.57401 c
41.8 88.57401 41.61101 88.58101 41.37 88.60201 c
41.37 88.658 l
41.37 88.707 41.38501 88.763 41.407 88.841 c
f
q
58.668 77.90601 m
49.76401 77.90601 l
49.76401 82.58301 l
58.668 82.58301 l
58.668 77.90601 l
W n
q
9.79201 0 0 5.35201 49.31401 77.48401 cm
/Im5 Do
Q
Q
q
58.668 82.58301 m
49.76401 82.58301 l
49.76401 88.56 l
49.83701 88.55301 49.91701 88.54601 49.983 88.54601 c
51.09801 88.56 l
52.02301 88.539 l
52.81 88.49701 53.364 88.47601 53.677 88.47601 c
53.757 88.47601 53.89601 88.483 54.08501 88.483 c
54.114 88.63 l
54.078 88.79901 l
53.96901 88.86201 53.772 88.93201 53.48801 89.01601 c
53.41501 89.037 53.269 89.07201 53.07201 89.12201 c
52.87601 89.17101 52.759 89.20601 52.73 89.22701 c
52.621 89.311 52.511 89.48 52.38701 89.74001 c
52.26401 89.992 52.00801 90.688 51.61501 91.811 c
50.864 93.79201 l
49.76401 96.65302 l
49.76401 101.313 l
60.28601 101.313 l
58.668 101.313 l
58.668 95.51601 l
58.543 95.48701 58.41901 95.453 58.297 95.414 c
57.80101 95.25301 57.33501 95.02101 56.87601 94.69801 c
56.869 95.66 l
56.869 95.77901 56.869 96.02501 56.87601 96.39 c
56.78801 96.425 56.72301 96.44 56.672 96.44 c
56.548 96.41801 l
56.351 96.145 56.14 95.93401 55.92101 95.78601 c
55.703 95.63901 55.27301 95.42801 54.62401 95.15401 c
54.573 94.88701 l
55.032 94.81 55.338 94.71901 55.491 94.60701 c
55.63 94.438 l
55.681 94.298 55.71701 93.97401 55.72501 93.46201 c
55.761 90.21001 l
55.80501 87.65302 55.834 85.91901 55.834 85.00601 c
55.834 84.90001 55.81201 84.79601 55.783 84.69 c
55.688 84.59201 55.57201 84.50101 55.41901 84.43001 c
54.479 84.255 l
54.464 84.09901 l
54.47101 83.925 l
55.666 83.90302 l
57.05101 83.90302 l
57.87401 83.87601 l
58.668 83.88701 l  
Colorspace: /CS0
Pattern: 0.149
ExtGState: /GS0
Font: /T1_0
ExtGState: /GS1
ExtGState: /GS2
Font: /T1_0
Pattern: 0.3569
Font: /T1_1
PropList: /MC0
Pattern: 0.4431
ExtGState: /GS0
XObject: /Im0
XObject: /Im1
XObject: /Im2
XObject: /Im3
XObject: /Im4
Pattern: 1
XObject: /Im5`

	prn := PageResourceNamesForContent(s)
	fmt.Print(prn)
	//t.Log(prn)
}
